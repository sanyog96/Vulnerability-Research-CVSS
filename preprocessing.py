import os, sys
import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
import glob

foldername = sys.argv[1]
# filename = sys.argv[1]
path = "losses/" + foldername + "/"
files = glob.glob(f'{path}*')

basenames = [filename.split('/')[2].split('.')[0] for filename in files if "train_loss_" in filename]
# df = pd.read_csv("Dataset/raw/" + filename + ".csv")
# print(set(list(df['label_id'])))
# print(df['label_id'].isna().sum())
# print(len(df))
# print(basenames)
for basename in basenames:
    print(basename)
    plt.clf()
    train_loss = np.load("losses/" + foldername + "/" + basename + ".npy")
    valid_loss = np.load("losses/" + foldername + "/" + basename.replace("train_loss_", "valid_loss_") + ".npy")
    plt.plot(range(0, len(train_loss)), train_loss, color='r', label="train")
    plt.plot(range(0, len(train_loss)), valid_loss, color='b', label="valid")
    plt.title(basename.split("train_loss_")[1])
    plt.ylabel("loss")
    plt.xlabel("epochs")
    plt.legend()
    plt.savefig("plots/" + foldername + "/" + basename.split("train_loss_")[1] + '.png')
    plt.show()